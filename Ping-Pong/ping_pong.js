(()=>{"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var n=function(){function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"up",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e(this,n),this.direction=t,this.speed=i,this.dx=0,this.dy=0,this.setDirection(this.direction,this.speed)}var i,r,o;return i=n,(r=[{key:"setDirection",value:function(e,t){switch(this.direction=e,this.speed=t,this.dy=0,this.direction){case"up":this.dy=-t;break;case"down":this.dy=t;break;default:this.dy=this.dy}}},{key:"kinematic",value:function(e,t){this.dx=e,this.dy=t}},{key:"move",value:function(e){e.x+=this.dx/1e3,e.y+=this.dy/1e3}}])&&t(i.prototype,r),o&&t(i,o),Object.defineProperty(i,"prototype",{writable:!1}),n}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function e(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:14,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:80;i(this,e),this.x=t,this.y=r,this.speed=o,this.width=c,this.height=a,this.velocity=new n}var t,o,c;return t=e,(o=[{key:"direction",value:function(e){this.velocity.setDirection(e,this.speed)}},{key:"bodyMove",value:function(){this.velocity.kinematic(this.dx,this.dy)}},{key:"update",value:function(){this.velocity.move(this)}}])&&r(t.prototype,o),c&&r(t,c),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=l(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},s.apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=y(e);if(t){var r=y(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return f(this,n)}}function f(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(e,"prototype",{value:Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),writable:!1}),t&&u(e,t)}(o,e);var t,n,i,r=h(o);function o(e,t,n,i,c){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=r.call(this,t,n)).game=e,a.r=i,a.width=a.r,a.height=a.r,a.color=c,a.speed=4e3,a.dx=a.speed,a.dy=a.speed,a.collisionShape={x:a.x,y:a.y,width:a.r,height:a.r},a}return t=o,(n=[{key:"draw",value:function(){this.game.screen.get("gamelayer").drawCircle(this.x,this.y,this.r,0,this.color)}},{key:"spawn",value:function(e){this.x=this.game.screen.get("gamelayer").element.width/2,this.y=this.game.screen.get("gamelayer").element.height/2,this.dx*=-1,this.dy*=e%2?1:-1}},{key:"update",value:function(e){this.y<=0&&(this.dy*=-1),this.y+this.r>=this.game.screen.get("gamelayer").element.height&&(this.dy*=-1),this.x+this.r>=this.game.screen.get("gamelayer").element.width&&(this.game.player1.scoreInc(),this.game.UI.updateUI(),this.spawn(e)),this.x-this.r<=0&&(this.game.player2.scoreInc(),this.game.UI.updateUI(),this.spawn(e)),this.game.collider.collides(this,this.game.player1)&&(this.dx*=-1),this.game.collider.collides(this,this.game.player2)&&(this.dx*=-1),this.bodyMove(),s(y(o.prototype),"update",this).call(this,e)}}])&&a(t.prototype,n),i&&a(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o}(o);function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var b=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:745,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:420;d(this,e),this.element=document.createElement("canvas"),this.context=this.element.getContext("2d"),this.element.width=t,this.element.height=n,document.querySelector("#game").append(this.element)}var t,n,i;return t=e,n=[{key:"fill",value:function(e){this.context.fillStyle=e,this.context.fillRect(0,0,this.element.width,this.element.height)}},{key:"drawRect",value:function(e,t,n,i,r){this.context.fillStyle=r,this.context.fillRect(e,t,n,i)}},{key:"drawRectRound",value:function(e,t,n,i,r,o,c){if(void 0===c&&(c=!0),void 0===r&&(r=5),"number"==typeof r)r={tl:r,tr:r,br:r,bl:r};else{var a={tl:0,tr:0,br:0,bl:0};for(var s in a)r[s]=r[s]||a[s]}this.context.beginPath(),this.context.moveTo(e+r.tl,t),this.context.lineTo(e+n-r.tr,t),this.context.quadraticCurveTo(e+n,t,e+n,t+r.tr),this.context.lineTo(e+n,t+i-r.br),this.context.quadraticCurveTo(e+n,t+i,e+n-r.br,t+i),this.context.lineTo(e+r.bl,t+i),this.context.quadraticCurveTo(e,t+i,e,t+i-r.bl),this.context.lineTo(e,t+r.tl),this.context.quadraticCurveTo(e,t,e+r.tl,t),this.context.closePath(),o&&(this.context.fillStyle=o,this.context.fill()),c&&(this.context.strokeStyle=o,this.context.stroke())}},{key:"drawCircle",value:function(e,t,n,i,r){var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(this.context.beginPath(),this.context.lineWidth=i,this.context.arc(e,t,n,0,2*Math.PI,!0),this.context.strokeStyle=r,o)return this.context.fillStyle=r,void this.context.fill();this.context.stroke(),this.context.closePath()}},{key:"print",value:function(e,t,n,i){this.context.fillStyle=i,this.context.font="bold 20px sans-serif",this.context.fillText(n,e,t)}},{key:"clear",value:function(){this.context.clearRect(0,0,this.element.width,this.element.height)}}],n&&g(t.prototype,n),i&&g(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function v(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var m=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,(n=[{key:"collides",value:function(e,t){if(e.y<t.y+t.height&&e.y+e.height>t.y&&e.x+e.width>t.x&&e.x<t.x+t.width)return!0}}])&&v(t.prototype,n),i&&v(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function w(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var x=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.up=!1,this.down=!1,this.idle=!1,this.keyMap=new Map(t),document.addEventListener("keydown",(function(e){return n.update(e,!0)})),document.addEventListener("keyup",(function(e){return n.update(e,!1)}))}var t,n,i;return t=e,(n=[{key:"update",value:function(e,t){this.keyMap.has(e.keyCode)&&(this[this.keyMap.get(e.keyCode)]=t)}}])&&w(t.prototype,n),i&&w(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function O(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function P(){return P="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=j(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(arguments.length<3?e:n):r.value}},P.apply(this,arguments)}function j(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=C(e)););return e}function R(e,t){return R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},R(e,t)}function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=C(e);if(t){var r=C(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return T(this,n)}}function T(e,t){if(t&&("object"===k(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function C(e){return C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},C(e)}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(e,"prototype",{value:Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),writable:!1}),t&&R(e,t)}(o,e);var t,n,i,r=E(o);function o(e,t,n,i,c){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(a=r.call(this,t,n)).game=e,a.control=i,a.score=0,a.color=c,a}return t=o,(n=[{key:"draw",value:function(){this.game.screen.get("gamelayer").drawRect(this.x,this.y,this.width,this.height,this.color)}},{key:"scoreInc",value:function(){this.score++}},{key:"update",value:function(){this.control.up?this.y>0?this.direction("up"):this.y=0:this.control.down?this.y+this.height<this.game.screen.get("gamelayer").element.height?this.direction("down"):this.y=this.game.screen.get("gamelayer").element.height-this.height:this.direction("idle"),P(C(o.prototype),"update",this).call(this)}}])&&O(t.prototype,n),i&&O(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o}(o);function D(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var _=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.posLeftY=this.game.screen.get("ui").element.width/4,this.posRightY=this.game.screen.get("ui").element.width-this.posLeftY,this.init()}var t,n,i;return t=e,(n=[{key:"init",value:function(){this.updateUI()}},{key:"updateUI",value:function(){this.game.screen.get("ui").clear(),this.game.screen.get("ui").drawRectRound(this.posLeftY-32,10,64,40,20,"rgba(38,38,38,0.7)"),this.game.screen.get("ui").print(this.game.player1.score>9?this.posLeftY-10:this.posLeftY-6,38,this.game.player1.score,"#52C5D4"),this.game.screen.get("ui").drawRectRound(this.posRightY-32,10,64,40,20,"rgba(38,38,38,0.7)"),this.game.screen.get("ui").print(this.game.player2.score>9?this.posRightY-10:this.posRightY-6,38,this.game.player2.score,"#EDEDED")}}])&&D(t.prototype,n),i&&D(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function I(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.screen=new Map([["background",new b],["gamelayer",new b],["ui",new b]]),this.control1=new x([[87,"up"],[83,"down"]]),this.control2=new x([[38,"up"],[40,"down"]]),this.player1=new S(this,10,200,this.control1,"#52C5D4"),this.player2=new S(this,this.screen.get("gamelayer").element.width-20,200,this.control2,"#EDEDED"),this.ball=new p(this,this.screen.get("gamelayer").element.width/2,100,10,"#D3F349"),this.collider=new m,this.UI=new _(this),this.init()}var t,n,i;return t=e,(n=[{key:"init",value:function(){var e=this;this.screen.get("background").fill("#424357"),this.screen.get("background").drawRect(this.screen.get("background").element.width/2-3,0,6,this.screen.get("background").element.height,"#585874"),this.screen.get("background").drawCircle(this.screen.get("background").element.width/2,this.screen.get("background").element.height/2,100,6,"#585874",!1),requestAnimationFrame((function(t){return e.loop(t)}))}},{key:"update",value:function(e){this.ball.update(e),this.player1.update(e),this.player2.update(e)}},{key:"loop",value:function(e){var t=this;this.screen.get("gamelayer").clear(),this.update(e),this.ball.draw(),this.player1.draw(),this.player2.draw(),requestAnimationFrame((function(e){return t.loop(e)}))}}])&&I(t.prototype,n),i&&I(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();window.onload=function(){new Y}})();